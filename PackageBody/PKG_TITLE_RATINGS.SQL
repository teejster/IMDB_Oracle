SET DEFINE OFF
CREATE OR REPLACE PACKAGE BODY IMDB_STAGE.PKG_TITLE_RATINGS AS
  PROCEDURE SP_TRUNCATE_TITLE_RATINGS IS
  BEGIN
    EXECUTE IMMEDIATE 'TRUNCATE TABLE IMDB_STAGE.TITLE_RATINGS';
  END SP_TRUNCATE_TITLE_RATINGS;
  
  PROCEDURE SP_INSERT_TITLE_RATINGS IS
  BEGIN
  
    INSERT /*+ APPEND */ INTO IMDB_STAGE.TITLE_RATINGS (
        TCONST,
        AVERAGE_RATING,
        NUM_VOTES)
      SELECT TRE.TCONST,
             TRE.AVERAGE_RATING,
             TRE.NUM_VOTES
        FROM IMDB_STAGE.TITLE_RATINGS_EXT TRE
    ;

  END SP_INSERT_TITLE_RATINGS;
  
  PROCEDURE SP_LOAD_TITLE_RATINGS IS
  BEGIN
    SP_TRUNCATE_TITLE_RATINGS;
    SP_INSERT_TITLE_RATINGS;
  END SP_LOAD_TITLE_RATINGS;
  
END PKG_TITLE_RATINGS;
/
SHOW ERR
SET DEFINE ON 
