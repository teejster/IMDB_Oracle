SET DEFINE OFF
CREATE OR REPLACE PACKAGE BODY IMDB_STAGE.PKG_TITLE_PRINCIPALS AS
  PROCEDURE SP_TRUNCATE_TITLE_PRINCIPALS IS
  BEGIN
    EXECUTE IMMEDIATE 'TRUNCATE TABLE IMDB_STAGE.TITLE_PRINCIPALS';
  END SP_TRUNCATE_TITLE_PRINCIPALS;
  
  PROCEDURE SP_INSERT_TITLE_PRINCIPALS IS
  BEGIN
  
    INSERT /*+ APPEND */ INTO IMDB_STAGE.TITLE_PRINCIPALS (
        TCONST,
        ORDERING,
        NCONST,
        CATEGORY,
        JOB,
        CHARACTERS)
      SELECT TPE.TCONST,
             TPE.ORDERING,
             TPE.NCONST,
             TPE.CATEGORY,
             TPE.JOB,
             TPE.CHARACTERS
        FROM IMDB_STAGE.TITLE_PRINCIPALS_EXT TPE
    ;

  END SP_INSERT_TITLE_PRINCIPALS;
  
  PROCEDURE SP_LOAD_TITLE_PRINCIPALS IS
  BEGIN
    SP_TRUNCATE_TITLE_PRINCIPALS;
    SP_INSERT_TITLE_PRINCIPALS;
  END SP_LOAD_TITLE_PRINCIPALS;
  
END PKG_TITLE_PRINCIPALS;
/
SHOW ERR
SET DEFINE ON 
