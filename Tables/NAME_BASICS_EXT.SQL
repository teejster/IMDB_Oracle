DROP TABLE IMDB_STAGE.NAME_BASICS_EXT;

CREATE TABLE IMDB_STAGE.NAME_BASICS_EXT (
  NCONST VARCHAR2(10),
  PRIMARY_NAME VARCHAR2(120),
  BIRTH_YEAR VARCHAR2(6),
  DEATH_YEAR VARCHAR2(6),
  PRIMARY_PROFESSION VARCHAR2(100),
  KNOWN_FOR_TITLES VARCHAR2(100))
  ORGANIZATION EXTERNAL (
    TYPE ORACLE_LOADER 
    DEFAULT DIRECTORY DIR_IMDB_STAGE
    ACCESS PARAMETERS (
      RECORDS DELIMITED BY NEWLINE
      SKIP 1
      NOBADFILE
      NODISCARDFILE
      NOLOGFILE
      DISABLE_DIRECTORY_LINK_CHECK
      FIELDS TERMINATED BY '\t'
      MISSING FIELD VALUES ARE NULL 
      REJECT ROWS WITH ALL NULL FIELDS
      (
        NCONST CHAR(10),
        PRIMARY_NAME CHAR(120),
        BIRTH_YEAR CHAR(6),
        DEATH_YEAR CHAR(6) ,
        PRIMARY_PROFESSION CHAR(100),
        KNOWN_FOR_TITLES CHAR(100))
      )
    LOCATION ('name.basics.csv')
  )
  REJECT LIMIT UNLIMITED
;

--select count(*) from imdb_stage.name_basics_ext;

