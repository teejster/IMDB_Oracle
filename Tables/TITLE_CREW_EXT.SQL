DROP TABLE IMDB_STAGE.TITLE_CREW_EXT;

CREATE TABLE IMDB_STAGE.TITLE_CREW_EXT (
  TCONST VARCHAR2(10),
  DIRECTORS VARCHAR2(4000),
  WRITERS VARCHAR2(4000))
  ORGANIZATION EXTERNAL (
    TYPE ORACLE_LOADER 
    DEFAULT DIRECTORY DIR_IMDB_STAGE
    ACCESS PARAMETERS (
      RECORDS DELIMITED BY NEWLINE
      SKIP 1
      NOBADFILE
      NODISCARDFILE
      NOLOGFILE
      DISABLE_DIRECTORY_LINK_CHECK
      FIELDS TERMINATED BY '\t'
      MISSING FIELD VALUES ARE NULL 
      REJECT ROWS WITH ALL NULL FIELDS
      (
        TCONST CHAR(10),
        DIRECTORS CHAR(4000),
        WRITERS CHAR(4000))
      )
    LOCATION ('title.crew.csv')
  )
  REJECT LIMIT UNLIMITED
;

