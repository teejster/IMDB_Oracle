DROP TABLE IMDB_STAGE.TITLE_AKAS_EXT;

CREATE TABLE IMDB_STAGE.TITLE_AKAS_EXT (
  TITLE_ID VARCHAR2(10),
  ORDERING NUMBER(4),
  TITLE VARCHAR2(1000),
  REGION VARCHAR2(4),
  LANGUAGE VARCHAR2(3),
  TYPES VARCHAR2(20),
  ATTRIBUTES VARCHAR2(100),
  IS_ORIGINAL_TITLE VARCHAR2(4))
  ORGANIZATION EXTERNAL (
    TYPE ORACLE_LOADER 
    DEFAULT DIRECTORY DIR_IMDB_STAGE
    ACCESS PARAMETERS (
      RECORDS DELIMITED BY NEWLINE
      SKIP 1
      NOBADFILE
      NODISCARDFILE
      NOLOGFILE
      DISABLE_DIRECTORY_LINK_CHECK
      FIELDS TERMINATED BY '\t'
      MISSING FIELD VALUES ARE NULL 
      REJECT ROWS WITH ALL NULL FIELDS
      (
        TITLE_ID CHAR(10),
        ORDERING CHAR(6),
        TITLE CHAR(1000),
        REGION CHAR(4),
        "LANGUAGE" CHAR(3),
        TYPES CHAR(20),
        ATTRIBUTES CHAR(100),
        IS_ORIGINAL_TITLE CHAR(4))
      )
    LOCATION ('title.akas.csv')
  )
  REJECT LIMIT UNLIMITED
;

