DROP TABLE IMDB_STAGE.TITLE_BASICS_EXT;

CREATE TABLE IMDB_STAGE.TITLE_BASICS_EXT (
  TCONST VARCHAR2(10),
  TITLE_TYPE VARCHAR2(12),
  PRIMARY_TITLE VARCHAR2(500),
  ORIGINAL_TITLE VARCHAR2(500),
  IS_ADULT VARCHAR2(2),
  START_YEAR VARCHAR2(4),
  END_YEAR VARCHAR2(4),
  RUNTIME_MINUTES VARCHAR2(6),
  GENRES VARCHAR2(100))
  ORGANIZATION EXTERNAL (
    TYPE ORACLE_LOADER 
    DEFAULT DIRECTORY DIR_IMDB_STAGE
    ACCESS PARAMETERS (
      RECORDS DELIMITED BY NEWLINE
      SKIP 1
      NOBADFILE
      NODISCARDFILE
      NOLOGFILE
      DISABLE_DIRECTORY_LINK_CHECK
      FIELDS TERMINATED BY '\t'
      MISSING FIELD VALUES ARE NULL 
      REJECT ROWS WITH ALL NULL FIELDS
      (
        TCONST CHAR(10),
        TITLE_TYPE CHAR(12),
        PRIMARY_TITLE CHAR(500),
        ORIGINAL_TITLE CHAR(500),
        IS_ADULT CHAR(2),
        START_YEAR CHAR(4),
        END_YEAR CHAR(4),
        RUNTIME_MINUTES CHAR(6),
        GENRES CHAR(100))
    )
    LOCATION ('title.basics.csv')
  )
  REJECT LIMIT UNLIMITED
;

